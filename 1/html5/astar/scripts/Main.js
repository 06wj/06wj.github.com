var grid ,astar;
var preMouseX = 0;
var preMouseY = 0;
var maxX,maxY;

var box =
[
	[1, 0, 1 , 1 ,1 ,1 ,1 ,1 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,1 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 1, 1 , 1 ,1 ,1 ,1 ,1 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,1 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,1 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,1 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1],
	[1, 0, 1 , 1 ,0 ,1 ,0 ,1 ,1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,1 ,1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1],
	[1, 0, 1 , 1 ,1 ,1 ,1 ,0 ,1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	
]

function main()
{
	init();
}

function init()
{
	grid = new Grid(box);
	grid.random(20,15);
	maxX = grid.numCols - 1;
	maxY = grid.numRows - 1;
	astar = new Astar();
}

 document.onclick = function(e)
 {
		grid.setStartNode(preMouseX, preMouseY);
		
		var x = parseInt((e.x - 50)/width);
		var y = parseInt((e.y - 70)/width);
		
		if(!grid.nodes[x][y].walkable) 
		{
			alert("当前点不能通过");
			return;
		}
		
		preMouseX = x;
		preMouseY = y;
		
		if(preMouseX > maxX) preMouseX = maxX;
		if(preMouseY > maxY) preMouseY = maxY;
		if(preMouseY < 0) preMouseY = 0;
		if(preMouseX < 0) preMouseX = 0;
		
		grid.setEndNode(preMouseX, preMouseY);
		astar.findPath(grid);
 }
 
 
 
 
 
 
 