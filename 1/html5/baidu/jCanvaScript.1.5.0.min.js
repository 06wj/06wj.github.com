/*!
 * jCanvaScript JavaScript Library v 1.5.0
 * http://jcscript.com/
 *
 * Copyright 2011, Alexander Savin
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */
(function(Y,y){var aa=[],ae=Math,f=ae.PI,u=f*2,U=0,P=0,L=false,S=/[A-z]+?/,O=/\d.\w\w/,a=Y.navigator.userAgent.match(/Firefox\/\w+\.\w+/i),C=180/f,R=ae.max,i=ae.min,x=ae.cos,J=ae.sin,M=ae.floor,o=ae.round,W=ae.abs,V=ae.pow,al=ae.sqrt,K=1000/60,c=(function(){return Y.requestAnimationFrame||Y.webkitRequestAnimationFrame||Y.mozRequestAnimationFrame||Y.oRequestAnimationFrame||Y.msRequestAnimationFrame||function(an,m){return setTimeout(an,K)}})(),G=(function(){return Y.cancelAnimationFrame||Y.webkitCancelRequestAnimationFrame||Y.mozCancelRequestAnimationFrame||Y.oCancelRequestAnimationFrame||Y.msCancelRequestAnimationFrame||clearTimeout})();if(a!=""&&a!==null){a=true}else{a=false}function ad(ap,an,ar){var at=aa[ap].layers[an].objs,au=aa[ap].layers[an].grdntsnptrns,ao=at.length,aq=au.length;ar=ar.slice(1);for(var m=0;m<ao;m++){if(at[m].optns.id==ar){return at[m]}}for(m=0;m<aq;m++){if(au[m].optns.id==ar){return au[m]}}return false}function ah(ao,an,at,av){var ap=aa[ao].layers[an].objs,au=aa[ao].layers[an].grdntsnptrns,ar=ap.length,aq=au.length;av=av.slice(1);for(var m=0;m<ar;m++){if(ap[m]._name==av){at.elements.push(ap[m])}}for(m=0;m<aq;m++){if(au[m]._name==av){at.elements.push(au[m])}}return at}function z(ap,an,aq){var at=aa[ap].layers[an].objs,au=aa[ap].layers[an].grdntsnptrns,ao=at.length,ar=au.length;for(var m=0;m<ao;m++){aq.elements.push(at[m])}for(m=0;m<ar;m++){aq.elements.push(au[m])}return aq}var N=function(aA,m){if(aA===y){return this}if(typeof aA=="object"){m=aA;aA=y}var az=-1,ap=-1,an=aa.length,aq=0,ay=E(),av,ar,ao,aw,au,at,ax;if(m===y){if(aA.charAt(0)=="#"){for(av=0;av<an;av++){ax=aa[av].layers.length;for(ar=0;ar<ax;ar++){at=ad(av,ar,aA);if(at){return at}}}}if(aA.charAt(0)=="."){for(av=0;av<an;av++){ax=aa[av].layers.length;for(ar=0;ar<ax;ar++){ay=ah(av,ar,ay,aA)}}return ay}}else{if(m.canvas!==y){for(av=0;av<an;av++){if(aa[av].optns.id==m.canvas){az=av;ao=aa[av];break}}}if(m.layer!==y){if(az!=-1){ax=ao.layers.length;for(av=0;av<ax;av++){if(ao.layers[av].optns.id==m.layer){ap=av;aw=ao.layers[av];break}}}else{for(av=0;av<an;av++){au=aa[av].layers;ax=au.length;for(ar=0;ar<ax;ar++){if(au[ar].optns.id==m.layer){az=av;ap=ar;ao=aa[av];aw=ao.layers[ar];break}}if(aw>-1){break}}}}if(ap<0&&az<0){return false}if(ap<0){au=ao.layers;ax=au.length;if(aA===y){for(ar=0;ar<ax;ar++){ay=z(az,ar,ay)}return ay}if(aA.charAt(0)=="#"){for(ar=0;ar<ax;ar++){at=ad(az,ar,aA);if(at){return at}}}if(aA.charAt(0)=="."){for(ar=0;ar<ax;ar++){ay=ah(az,ar,ay,aA)}return ay}}else{if(aA===y){return z(az,ap,ay)}if(aA.charAt(0)=="#"){return ad(az,ap,aA)}if(aA.charAt(0)=="."){return ah(az,ap,ay,aA)}}}};function ab(m,ao){for(var an in ao){if(m[an]===y){m[an]=ao[an]}}return m}function j(m){B(m).optns.redraw=1}function D(){var aq=this.animateQueue.length,m=1;for(var an=0;an<aq;an++){var ar=this.animateQueue[an];for(var ax in ar){if(this[ax]!==y){if(ar[ax]){var aw=ar[ax];var ao=aw.step;var ap=aw.duration;var at=aw.easing;var av=aw.to;var au=aw.from;aw.step++;m=ao/ap;F(ax,this,ar);if(at.type=="in"||(at.type=="inOut"&&m<0.5)){this[ax]=(av-au)*h[at.fn](m,at)+au}if(at.type=="out"||(at.type=="inOut"&&m>0.5)){this[ax]=(av-au)*(1-h[at.fn](1-m,at))+au}if(aw.onstep){aw.onstep.fn.call(this,aw.onstep)}if(ao>ap){this[ax]=av;F(ax,this,ar);ar[ax]=false;ar.animateKeyCount--}}else{if(!ar.animateKeyCount){if(ar.animateFn){ar.animateFn.apply(this)}this.animateQueue.splice(an,1);an--}}}}}if(aq==0){this.optns.animated=false}else{j(this)}return this}function F(ao,an,m){var aq=an[ao];var ap=m[ao]["prev"];switch(ao){case"_rotateAngle":an.rotate(aq-ap,an._rotateX,an._rotateY);break;case"_translateX":an.translate(aq-ap,0);break;case"_translateY":an.translate(0,aq-ap);break;case"_scaleX":if(!ap){ap=1}an.scale(aq/ap,1);break;case"_scaleY":if(!ap){ap=1}an.scale(1,aq/ap);break;default:return}m[ao]["prev"]=aq}function ac(ao,an,m){ao=ao||Y.event;m[an].event=ao;m[an].code=ao.charCode||ao.keyCode;m[an].val=true;m.redraw=1;return false}function t(ap,ao,an){ap=ap||Y.event;var m={pageX:ap.pageX||ap.clientX,pageY:ap.pageY||ap.clientY};an[ao].event=ap;an[ao].x=m.pageX-an.x;an[ao].y=m.pageY-an.y;if(an[ao].val){an.redraw=1}return false}function w(an,m){if(an===y){this["on"+m]()}else{this["on"+m]=an}if(m=="mouseover"||m=="mouseout"){m="mousemove"}B(this).optns[m].val=true;return this}function ak(an,m){if(an===y){this[m]()}else{this[m]=an}return this}var h={linear:function(m,an){return m},exp:function(m,an){var ao=an.n||2;return V(m,ao)},circ:function(m,an){return 1-al(1-m*m)},sine:function(m,an){return 1-J((1-m)*f/2)},back:function(an,ao){var ap=ao.n||2;var m=ao.x||1.5;return V(an,ap)*((m+1)*an-m)},elastic:function(aq,ar){var at=ar.n||2;var ao=ar.m||20;var ap=ar.k||3;var an=ar.x||1.5;return V(at,10*(aq-1))*x(ao*aq*f*an/ap)},bounce:function(ao,ar){var at=ar.n||4;var an=ar.b||0.25;var aq=[1];for(var ap=1;ap<at;ap++){aq[ap]=aq[ap-1]+V(an,ap/2)}var m=2*aq[at-1]-1;for(ap=0;ap<at;ap++){if(m*ao>=(ap>0?2*aq[ap-1]-1:0)&&m*ao<=2*aq[ap]-1){return V(m*(ao-(2*aq[ap]-1-V(an,ap/2))/m),2)+1-V(an,ap)}}return 1}},g={color:{fn:function(at,m,ao,ar){var an,aq,ap;ao=ao[ar];for(aq=0;aq<at;aq++){for(ap=0;ap<m;ap++){an=this.getPixel(aq,ap);an[ao[0]]=an[ao[0]]*2-an[ao[1]]-an[ao[2]];an[ao[1]]=0;an[ao[2]]=0;an[ao[0]]=an[ao[0]]>255?255:an[ao[0]];this.setPixel(aq,ap,an)}}},matrix:{red:[0,1,2],green:[1,0,2],blue:[2,0,1]}},linear:{fn:function(an,ay,aw,av){var ax=[],ap,au,at,ar,aq,ao;aw=aw[av];aq=aw.length;ao=aw[0].length;for(au=0;au<an;au++){ax[au]=[];for(at=0;at<ay;at++){ax[au][at]=[0,0,0,1];for(aq=0;aq<3;aq++){for(ao=0;ao<3;ao++){ap=this.getPixel(au-parseInt(aq/2),at-parseInt(ao/2));for(ar=0;ar<3;ar++){ax[au][at][ar]+=ap[ar]*aw[aq][ao]}}}}}for(au=0;au<an;au++){for(at=0;at<ay;at++){this.setPixel(au,at,ax[au][at])}}},matrix:{sharp:[[-0.375,-0.375,-0.375],[-0.375,4,-0.375],[-0.375,-0.375,-0.375]],blur:[[0.111,0.111,0.111],[0.111,0.111,0.111],[0.111,0.111,0.111]]}}};function n(an,m){return[[(an[0][0]*m[0][0]+an[0][1]*m[1][0]),(an[0][0]*m[0][1]+an[0][1]*m[1][1]),(an[0][0]*m[0][2]+an[0][1]*m[1][2]+an[0][2])],[(an[1][0]*m[0][0]+an[1][1]*m[1][0]),(an[1][0]*m[0][1]+an[1][1]*m[1][1]),(an[1][0]*m[0][2]+an[1][1]*m[1][2]+an[1][2])]]}function s(ao,ap,an){return{x:(ao*an[0][0]+ap*an[0][1]+an[0][2]),y:(ao*an[1][0]+ap*an[1][1]+an[1][2])}}function Z(ao,ap,an){return{x:(ao*an[1][1]-ap*an[0][1]+an[0][1]*an[1][2]-an[1][1]*an[0][2])/(an[0][0]*an[1][1]-an[1][0]*an[0][1]),y:(-ao*an[1][0]+ap*an[0][0]-an[0][0]*an[1][2]+an[1][0]*an[0][2])/(an[0][0]*an[1][1]-an[1][0]*an[0][1])}}function b(aw,aB,aA){if(aA=="poor"){return aB}var ax={x:aB.x,y:aB.y},aC={x:aB.x+aB.width,y:aB.y+aB.height},at=n(aw.matrix(),af(aw).matrix()),ay=s(ax.x,ax.y,at),av=s(aC.x,ax.y,at),aq=s(ax.x,aC.y,at),ap=s(aC.x,aC.y,at),aD=[[ay.x,ay.y],[av.x,av.y],[aq.x,aq.y],[ap.x,ap.y]];if(aA=="coords"){return aD}var au,ar,ao=au=ay.x,an=ar=ay.y;for(var az=0;az<4;az++){if(ao<aD[az][0]){ao=aD[az][0]}if(an<aD[az][1]){an=aD[az][1]}if(au>aD[az][0]){au=aD[az][0]}if(ar>aD[az][1]){ar=aD[az][1]}}return{x:au,y:ar,width:ao-au,height:an-ar}}function aj(an){var m={};if(an.objs!==y||an._img!==y||an._proto=="text"){var ap=an.getRect("poor");m.x=(ap.x*2+ap.width)/2;m.y=(ap.y*2+ap.height)/2;return m}if(an._width!==y&&an._height!==y){m.x=(an._x*2+an._width)/2;m.y=(an._y*2+an._height)/2;return m}if(an._radius!==y){m.x=an._x;m.y=an._y;return m}if(an.shapesCount!==y){m.x=an._x0;m.y=an._y0;for(var ao=1;ao<an.shapesCount;ao++){m.x+=an["_x"+ao];m.y+=an["_y"+ao]}m.x=m.x/an.shapesCount;m.y=m.y/an.shapesCount;return m}return false}function r(ap){var an={color:{val:ap,notColor:y},r:0,g:0,b:0,a:1};if(ap.id!==y){an.color.notColor={level:ap._level,canvas:ap.optns.canvas.number,layer:ap.optns.layer.number};return an}if(ap.r!==y){an=ab(ap,{r:0,g:0,b:0,a:1});an.color={val:"rgba("+an.r+","+an.g+","+an.b+","+an.a+")",notColor:y};return an}if(ap.charAt(0)=="#"){an.r=parseInt(ap.substr(1,2),16);an.g=parseInt(ap.substr(3,2),16);an.b=parseInt(ap.substr(5,2),16)}else{var m=ap.split(",");if(m.length==4){var ao=m[0].split("(");var ar=m[3].split(")");an.r=parseInt(ao[1]);an.g=parseInt(m[1]);an.b=parseInt(m[2]);an.a=parseFloat(ar[0])}if(m.length==3){ao=m[0].split("(");var aq=m[2].split(")");an.r=parseInt(ao[1]);an.g=parseInt(m[1]);an.b=parseInt(aq[0])}}an.color.notColor=y;return an}function A(m){if(m.getBoundingClientRect){return q(m)}else{return am(m)}}function am(m){var ao=0,an=0;while(m){ao=ao+parseInt(m.offsetTop);an=an+parseInt(m.offsetLeft);m=m.offsetParent}return{top:ao,left:an}}function q(ap){var at=ap.getBoundingClientRect();var au=document.body;var an=document.documentElement;var m=Y.pageYOffset||an.scrollTop||au.scrollTop;var aq=Y.pageXOffset||an.scrollLeft||au.scrollLeft;var ar=an.clientTop||au.clientTop||0;var av=an.clientLeft||au.clientLeft||0;var aw=at.top+m-ar;var ao=at.left+aq-av;return{top:o(aw),left:o(ao)}}function ag(an,m){p(an,m);ai(an,m)}function ai(an,m){if(!an.optns.focused){return}if(m.keyDown.val!=false){if(typeof an.onkeydown=="function"){an.onkeydown(m.keyDown)}}if(m.keyUp.val!=false){if(typeof an.onkeyup=="function"){an.onkeyup(m.keyUp)}}if(m.keyPress.val!=false){if(typeof an.onkeypress=="function"){an.onkeypress(m.keyPress)}}}function I(aq,an,au){var m={};var ap=B(aq);var ao=ap.optns.ctx;var at=ap.layers[aq.optns.layer.number];m.x=an;m.y=au;if(a){m=Z(an,au,n(aq.matrix(),at.matrix()))}if(ao.isPointInPath===y||aq._img!==y||aq._imgData!==y||aq._proto=="text"){var ar=aq.getRect("poor");m=Z(an,au,n(aq.matrix(),at.matrix()));if(ar.x<=m.x&&ar.y<=m.y&&(ar.x+ar.width)>=m.x&&(ar.y+ar.height)>=m.y){return m}}else{if(ao.isPointInPath(m.x,m.y)){return m}}return false}function p(ap,ao){var an=false;var m=ao.mousemove.x||ao.mousedown.x||ao.mouseup.x||ao.dblclick.x||ao.click.x;var aq=ao.mousemove.y||ao.mousedown.y||ao.mouseup.y||ao.dblclick.y||ao.click.y;if(m!=false){an=I(ap,m,aq)}if(an){if(ao.mousemove.x!=false){ao.mousemove.object=ap}if(ao.mousedown.x!=false){ao.mousedown.object=ap}if(ao.click.x!=false||ao.dblclick.x!=false){ao.click.object=ap}if(ao.dblclick.x!=false){ao.dblclick.object=ap}if(ao.mouseup.x!=false){ao.mouseup.object=ap}ao.point=an}}function af(m){return B(m).layers[m.optns.layer.number]}function B(m){return aa[m.optns.canvas.number]}function e(au,m,ap){j(m);var an=m.optns.canvas;var ao=m.optns.layer;if(au===y){return ao.id}if(ao.id==au){return m}var aq={i:an.number,j:ao.number};ao.id=au;var at=N.layer(au);var av={i:at.optns.canvas.number,j:at.optns.number};var ar=aa[aq.i].layers[aq.j][ap],aw=aa[av.i].layers[av.j][ap];ar.splice(m.optns.number,1);m._level=m.optns.number=aw.length;aw[m._level]=m;ao.number=av.j;an.number=av.i;an.id=at.optns.canvas.id;j(m);return m}function H(ap,ao){for(var an in ao){switch(typeof ao[an]){case"function":if(an.substr(0,2)=="on"){break}if(ap[an]===y){ap[an]=ao[an]}break;case"object":if(an=="optns"||an=="animateQueue"){break}if(an=="objs"||an=="grdntsnptrns"){for(var m in ao[an]){if(ao[an].hasOwnProperty(m)){ao[an][m].clone().layer(ap.optns.id)}}break}if(!ao[an]||an==="ctx"){continue}ap[an]=typeof ao[an].pop==="function"?[]:{};H(ap[an],ao[an]);break;default:if(an=="_level"){break}ap[an]=ao[an]}}}function l(ar,m,aq){j(m);var an=m.optns.canvas;var ap=m.optns.layer;if(ar===y){return aa[an.number].optns.id}if(aa[an.number].optns.id==ar){return m}var at={i:an.number,j:ap.number};N.canvas(ar);for(var ao=0;ao<aa.length;ao++){var aw=aa[ao]}if(aw.optns.id==ar){var au=aa[at.i].layers[at.j][aq],av=aw.layers[0][aq];au.splice(m.optns.number,1);m._level=m.optns.number=av.length;av[m._level]=m;ap.number=0;an.number=ao;an.id=aw.optns.id;ap.id=aw.layers[0].optns.id}j(m);return m}function d(an){for(var m=0;m<an.length;m++){an[m].optns.number=m}}function k(au,av,aw,ao,at){var ap=au.length,m,an,ar;for(var aq=0;aq<ap;aq++){m=au[aq].optns;an=m.canvas;ar=m.layer;an.id=ao;an.number=at;ar.id=av;ar.number=aw}}function Q(m){m.sort(function(ao,an){if(ao._level>an._level){return 1}if(ao._level<an._level){return -1}return 0});d(m);return m.length}function T(an){for(var m=0;m<an.length;m++){if(an[m].optns.deleted){an.splice(m,1)}}d(an);return an.length}var v={};v.object=function(){this.position=function(){return s(this._x,this._y,n(this.matrix(),af(this).matrix()))};this.buffer=function(ar){var ao=this.optns.buffer;if(ar===y){if(ao.val){return ao.cnv}else{return false}}if(ao.val===ar){return this}if(ar){var an=ao.cnv=document.createElement("canvas");var m=ao.ctx=an.getContext("2d");var aq=ao.rect=this.getRect();an.setAttribute("width",aq.width);an.setAttribute("height",aq.height);var ap=this.transform();ao.x=this._x;ao.y=this._y;ao.dx=this._transformdx;ao.dy=this._transformdy;this._x=this._y=0;this.transform(1,0,0,1,-aq.x+ao.dx,-aq.y+ao.dy,true);this.setOptns(m);H(ao.optns={},B(this).optns);ao.optns.ctx=m;this.draw(m);this._x=ao.x;this._y=ao.y;ap[0][2]=aq.x;ap[1][2]=aq.y;this.matrix(ap);ao.val=true}else{this.translate(-ao.rect.x+ao.dx,-ao.rect.y+ao.dy);this.optns.buffer={val:false}}return this};this.clone=function(m){var an=new v[this._proto];v[this._proto].prototype.base.call(an);H(an,this);an.layer(af(this).optns.id);if(m===y){return an}return an.animate(m)};this.shadow=function(an){for(var ao in an){switch(ao){case"x":this._shadowX=an.x;break;case"y":this._shadowY=an.y;break;case"blur":this._shadowBlur=an.blur;break;case"color":var m=r(an.color);this._shadowColor=an.color.val;this._shadowColorR=m.r;this._shadowColorG=m.g;this._shadowColorB=m.b;this._shadowColorA=m.a;break}}j(this);return this};this.setOptns=function(m){m.globalAlpha=this._opacity;m.shadowOffsetX=this._shadowX;m.shadowOffsetY=this._shadowY;m.shadowBlur=this._shadowBlur;m.globalCompositeOperation=this._composite;m.shadowColor="rgba("+this._shadowColorR+","+this._shadowColorG+","+this._shadowColorB+","+this._shadowColorA+")";if(this.scaleMatrix){this.matrix(n(this.matrix(),this.scaleMatrix));this.scaleMatrix=false}if(this.rotateMatrix){this.matrix(n(this.matrix(),this.rotateMatrix));this.rotateMatrix=false}m.transform(this._transform11,this._transform12,this._transform21,this._transform22,this._transformdx,this._transformdy);return this};this.up=function(an){if(an===y){an=1}if(an=="top"){this.level(an)}else{var m=af(this).objs[this.optns.number+an];if(m!==y){an=m._level+1-this._level}this.level(this._level+an)}return this};this.down=function(an){if(an==y){an=1}if(an=="bottom"){this.level(an)}else{var m=af(this).objs[this.optns.number-an];if(m!==y){an=this._level-(m._level-1)}this.level(this._level-an)}return this};this.level=function(an){if(an==y){return this._level}var m=af(this);if(an=="bottom"){if(this.optns.number==0){an=this._level}else{an=m.objs[0]._level-1}}if(an=="top"){if(this.optns.number==m.objs.length){an=this._level}else{an=m.objs[m.objs.length-1]._level+1}}this._level=an;m.optns.anyObjLevelChanged=true;j(this);return this};this.del=function(){this.optns.deleted=true;af(this).optns.anyObjDeleted=true;j(this)};this.focus=function(m){if(m===y){this.optns.focused=true;if(typeof this.onfocus=="function"){this.onfocus()}}else{this.onfocus=m}return this};this.blur=function(m){if(m===y){this.optns.focused=false;if(typeof this.onblur=="function"){this.onblur()}}else{this.onblur=m}return this};this.click=function(m){return w.call(this,m,"click")};this.dblclick=function(m){return w.call(this,m,"dblclick")};this.keypress=function(m){return ak.call(this,m,"onkeypress")};this.keydown=function(m){return ak.call(this,m,"onkeydown")};this.keyup=function(m){return ak.call(this,m,"onkeyup")};this.mousedown=function(m){return w.call(this,m,"mousedown")};this.mouseup=function(m){return w.call(this,m,"mouseup")};this.mousemove=function(m){return w.call(this,m,"mousemove")};this.mouseover=function(m){return w.call(this,m,"mouseover")};this.mouseout=function(m){return w.call(this,m,"mouseout")};this.attr=function(ao,an){if(typeof ao==="object"){var m=ao}else{if(an===y){return this["_"+ao]}m={};m[ao]=an}return this.animate(m)};this.queue=function(){var ap=this.animateQueue.length,ar,aq,ao,av,an=0,m=0,au,at=arguments;for(aq=0;aq<at.length;aq++){if(typeof at[aq]=="function"){at[aq].apply(this);at[aq]=false;aq++;if(this.animateQueue.length>ap){for(ao=ap;ao<this.animateQueue.length;ao++){ar=this.animateQueue[ao];for(av in ar){if(ar[av].duration!==y){if(ar[av].duration>an){an=ar[av].duration;m=ao}break}}}if(an){ar=this.animateQueue[m];if(ar.animateFn){au=ar.animateFn;ar.animateFn=function(){au.apply(this);this.queue.apply(this,at)}}else{ar.animateFn=function(){this.queue.apply(this,at)}}break}}}}};this.stop=function(ap,aq){this.optns.animated=false;if(aq===y){aq=false}if(ap===y){ap=false}for(var ao=0;ao<this.animateQueue.length;ao++){var m=this.animateQueue[ao];if(aq){m.animateFn.call(this)}if(ap){for(var an in m){if(m[an]["from"]!==y){this[an]=m[an]["to"];F(an,this,m)}}}}this.animateQueue=[];return this};this.animate=function(aw,m,aq,ar,at){if(m===y){m=1}else{if(typeof m=="function"){at=m;m=1}if(typeof m=="object"){aq=m;m=1}}if(m!=1){m=m/K}if(aq===y){aq={fn:"linear",type:"in"}}else{if(typeof aq=="function"){at=aq;aq={fn:"linear",type:"in"}}if(aq.type===y){aq.type="in"}}if(ar===y){ar=false}else{if(typeof ar=="function"){at=ar;ar=false}}if(aw.scale!==y){this._scaleX=this._scaleY=1;if(typeof aw.scale!="object"){aw.scaleX=aw.scaleY=aw.scale}else{aw.scaleX=aw.scale.x||1;aw.scaleY=aw.scale.y||1}}if(aw.translate!==y){this._translateX=this._translateY=0;if(typeof aw.translate!="object"){aw.translateX=aw.translateY=aw.translate}else{aw.translateX=aw.translate.x||0;aw.translateY=aw.translate.y||0}aw.translate=y}if(aw.rotate!==y){aw.rotateAngle=aw.rotate.angle;this._rotateAngle=0;this._rotateX=aw.rotate.x||0;this._rotateY=aw.rotate.y||0;aw.rotate=y}if(aw.color!==y){var ao=r(aw.color);if(ao.color.notColor){this.optns.color.notColor=ao.color.notColor}else{aw.colorR=ao.r;aw.colorG=ao.g;aw.colorB=ao.b;aw.alpha=ao.a}aw.color=y}if(aw.shadowColor!==y){ao=r(aw.shadowColor);aw.shadowColorR=ao.r;aw.shadowColorG=ao.g;aw.shadowColorB=ao.b;aw.shadowColorA=ao.a;aw.shadowColor=y}if(m>1){var ap=this.animateQueue[this.animateQueue.length]={animateKeyCount:0};ap.animateFn=at||false;this.optns.animated=true}for(var av in aw){if(this["_"+av]!==y&&aw[av]!==y){var an=aw[av],au="_"+av;if(an!=this[au]){if(an.charAt){if(av=="string"){this._string=an}else{if(an.charAt(1)=="="){an=this[au]+parseInt(an.charAt(0)+"1")*parseInt(an.substr(2))}else{if(!S.test(an)){an=parseInt(an)}else{this[au]=an}}}}if(m==1){this[au]=an}else{ap[au]={from:this[au],to:an,duration:m,step:1,easing:aq,onstep:ar,prev:0};ap.animateKeyCount++}}}}if(m==1){if(aw.rotateAngle){this.rotate(this._rotateAngle,this._rotateX,this._rotateY)}if(aw.translateX||aw.translateY){this.translate(this._translateX,this._translateY)}if(aw.scaleX||aw.scaleY){this.scale(this._scaleX,this._scaleY)}}j(this);return this};this.matrix=function(an){if(an===y){return[[this._transform11,this._transform21,this._transformdx],[this._transform12,this._transform22,this._transformdy]]}this._transform11=an[0][0];this._transform21=an[0][1];this._transform12=an[1][0];this._transform22=an[1][1];this._transformdx=an[0][2];this._transformdy=an[1][2];return this};this.translateTo=function(m,av,an,ao,ap,ar){var au=this.position(),at=m-au.x,aq=av-au.y;return this.translate(at,aq,an,ao,ap,ar)};this.translate=function(m,ar,ap,aq,ao,an){if(ap!==y){return this.animate({translate:{x:m,y:ar}},ap,aq,ao,an)}this.matrix(n(this.matrix(),[[1,0,m],[0,1,ar]]));j(this);return this};this.scale=function(m,ar,ap,aq,ao,an){if(ap!==y){return this.animate({scale:{x:m,y:ar}},ap,aq,ao,an)}if(ar===y){ar=m}if(this.scaleMatrix){this.scaleMatrix=n(this.scaleMatrix,[[m,0,this._x*(1-m)],[0,ar,this._y*(1-ar)]])}else{this.scaleMatrix=[[m,0,this._x*(1-m)],[0,ar,this._y*(1-ar)]]}j(this);return this};this.rotate=function(av,m,au,an,ao,aq,ar){if(an!==y){return this.animate({rotate:{angle:av,x:m,y:au}},an,ao,aq,ar)}j(this);av=av/C;var ax=x(av);var ap=J(av);var at=[];if(m===y){at=[[ax,-ap,0],[ap,ax,0]]}else{if(m=="center"){var aw=aj(this);if(au===y){m=aw.x;au=aw.y}else{m=aw.x+au.x;au=aw.y+au.y}}at=[[ax,-ap,-m*(ax-1)+au*ap],[ap,ax,-au*(ax-1)-m*ap]]}if(this.rotateMatrix){this.rotateMatrix=n(this.rotateMatrix,at)}else{this.rotateMatrix=at}return this};this.transform=function(at,ar,av,au,ap,ao,aq){if(at===y){return this.matrix()}if(aq!==y){this.matrix([[at,av,ap],[ar,au,ao]])}else{var an=n(this.matrix(),[[at,av,ap],[ar,au,ao]]);this.matrix(an)}j(this);return this};this.beforeDraw=function(m){if(!this._visible){return false}m.save();if(this.optns.clipObject){var an=this.optns.clipObject;an._visible=true;if(an.optns.animated){D.call(an)}an.setOptns(m);m.beginPath();an.draw(m);m.clip()}this.setOptns(m);if(this.optns.animated){D.call(this)}m.beginPath();return true};this.clip=function(m){if(m===y){return this.optns.clipObject}af(this).objs.splice(m.optns.number,1);this.optns.clipObject=m;return this};this.afterDraw=function(m){m.ctx.closePath();ag(this,m);m.ctx.restore();if(this.optns.clipObject){v.shape.prototype.afterDraw.call(this.optns.clipObject,m)}};this.isPointIn=function(an,ar,ap){var aq=B(this).optns;var ao=aq.ctx;if(ap!==y){an-=aq.x;ar-=aq.y}ao.save();ao.beginPath();this.draw(ao);var m=I(this,an,ar);ao.closePath();ao.restore();if(m){return true}return false};this.layer=function(m){return e(m,this,"objs")};this.canvas=function(m){return l(m,this,"objs")};this.draggable=function(an,ar,ap){var aq=this;var ao=this.optns.drag;if(typeof ar==="function"){ap=ar;ar=y}if(typeof an=="function"){ap=an;an=y}ao.shiftX=0;ao.shiftY=0;if(ar!==y){if(ar.shiftX!==y){ao.shiftX=ar.shiftX;ar.shiftX=y}if(ar.shiftY!==y){ao.shiftY=ar.shiftY;ar.shiftY=y}}if(an!==y){if(an.id){aq=(ar===y)?an.visible(false):an.animate(ar).visible(false)}if(an=="clone"){aq=this.clone(ar).visible(false);ao.type="clone"}}ao.val=true;ao.x=this._x;ao.y=this._y;ao.dx=this._transformdx;ao.dy=this._transformdy;ao.object=aq;ao.params=ar;ao.fn=ap||false;var m=B(this).optns;m.mousemove.val=true;m.mousedown.val=true;m.mouseup.val=true;return this};this.droppable=function(m){this.optns.drop.val=true;if(m!==y){this.optns.drop.fn=m}return this};this.name=function(m){return this.attr("name",m)};this.visible=function(m){return this.attr("visible",m)};this.composite=function(m){return this.attr("composite",m)};this.id=function(m){if(m===y){return this.optns.id}this.optns.id=m;return this};this.opacity=function(m){return this.attr("opacity",m)};this.fadeIn=function(ao,ap,an,m){return this.fadeTo(1,ao,ap,an,m)};this.fadeOut=function(ao,ap,an,m){return this.fadeTo(0,ao,ap,an,m)};this.fadeTo=function(ap,ao,aq,an,m){if(ao===y){ao=600}return this.animate({opacity:ap},ao,aq,an,m)};this.fadeToggle=function(ao,ap,an,m){if(this._opacity){this.fadeOut(ao,ap,an,m)}else{this.fadeIn(ao,ap,an,m)}return this};this.instanceOf=function(m){if(m===y){return this._proto}return this instanceof v[m]};this.base=function(an,ar,m){if(typeof an=="object"){an=ab(an,{x:0,y:0,service:false});m=an.service;ar=an.y;an=an.x}else{if(m===y){m=false}}var ap=aa[U];this.optns={animated:false,clipObject:false,drop:{val:false,fn:function(){}},drag:{val:false},layer:{id:ap.optns.id+"Layer0",number:0},canvas:{number:0},focused:false,buffer:{val:false}};this.animateQueue=[];this._x=an;this._y=ar;if(m==false&&ap!==y&&ap.layers[0]!==y){this.optns.layer.number=0;this.optns.canvas.number=U;var aq=af(this),ao=aq.objs.length;this.optns.number=ao;this._level=ao?(aq.objs[ao-1]._level+1):0;aq.objs[ao]=this;this.optns.layer.id=aq.optns.id;j(this)}return this};this._visible=true;this._composite="source-over";this._name="";this._opacity=1;this._shadowX=0;this._shadowY=0;this._shadowBlur=0;this._shadowColor="rgba(0,0,0,0)";this._shadowColorR=0;this._shadowColorG=0;this._shadowColorB=0;this._shadowColorA=0;this._translateX=0;this._translateY=0;this._scaleX=1;this._scaleY=1;this._rotateAngle=0;this._rotateX=0;this._rotateY=0;this._transform11=1;this._transform12=0;this._transform21=0;this._transform22=1;this._transformdx=0;this._transformdy=0;this.rotateMatrix=this.scaleMatrix=false};v.object.prototype=new v.object();v.shape=function(){this.color=function(m){if(m===y){return[this._colorR,this._colorG,this._colorB,this._alpha]}return this.attr("color",m)};this.lineStyle=function(m){return this.attr(m)};this.setOptns=function(an){v.shape.prototype.setOptns.call(this,an);an.lineWidth=this._lineWidth;an.lineCap=this._cap;an.lineJoin=this._join;an.miterLimit=this._miterLimit;var ao=this.optns.color;if(ao.notColor===y){ao.val="rgba("+parseInt(this._colorR)+","+parseInt(this._colorG)+","+parseInt(this._colorB)+","+parseInt(this._alpha*100)/100+")"}else{var m=ao.notColor;var ap=aa[m.canvas].layers[m.layer];if(ap.grdntsnptrns[m.level]!==y){ao.val=ap.grdntsnptrns[m.level].val}}if(this._fill){an.fillStyle=ao.val}else{an.strokeStyle=ao.val}};this.afterDraw=function(m){if(this._fill){m.ctx.fill()}else{m.ctx.stroke()}v.shape.prototype.afterDraw.call(this,m)};this.base=function(m){if(m===y){m={}}if(m.color===y){m.color="rgba(0,0,0,1)"}else{if(!m.color.charAt&&m.color.id===y&&m.color.r===y){m.fill=m.color;m.color="rgba(0,0,0,1)"}}m=ab(m,{color:"rgba(0,0,0,1)",fill:0});v.shape.prototype.base.call(this,m);this._fill=m.fill;this.optns.color={val:m.color,notColor:y};return this.color(m.color)};this._colorR=0;this._colorG=0;this._colorB=0;this._alpha=0;this._lineWidth=1;this._cap="butt";this._join="miter";this._miterLimit=1};v.shape.prototype=new v.object;v.lines=function(){this.position=function(){return s(this._x0,this._y0,n(this.matrix(),af(this).matrix()))};this.getRect=function(ap){var m,at,ar=m=this._x0,aq=at=this._y0;for(var an=1;an<this.shapesCount;an++){if(ar<this["_x"+an]){ar=this["_x"+an]}if(aq<this["_y"+an]){aq=this["_y"+an]}if(m>this["_x"+an]){m=this["_x"+an]}if(at>this["_y"+an]){at=this["_y"+an]}}var ao={x:m,y:at,width:ar-m,height:aq-at};return b(this,ao,ap)};this.addPoint=function(){j(this);var an=this.pointNames;for(var m=0;m<an.length;m++){this[an[m]+this.shapesCount]=arguments[m]}this.shapesCount++;return this};this.delPoint=function(an,aq,m){j(this);if(aq===y){var ap=this.points();ap.splice(an,1);this.points(ap)}else{m=m||0;for(var ao=0;ao<this.shapesCount;ao++){if(this["_x"+ao]<an+m&&this["_x"+ao]>an-m&&this["_y"+ao]<aq+m&&this["_y"+ao]<aq+m){this.delPoint(ao);ao--}}}return this};this.points=function(ap){var aq=this.pointNames;if(ap===y){ap=[];for(var an=0;an<this.shapesCount;an++){ap[an]=[];for(var ao=0;ao<aq.length;ao++){ap[an][ao]=this[aq[ao]+an]}}return ap}j(this);var m=this.shapesCount;this.shapesCount=ap.length;for(an=0;an<this.shapesCount;an++){for(ao=0;ao<aq.length;ao++){this[aq[ao]+an]=ap[an][ao]}}for(an=this.shapesCount;an<m;an++){for(ao=0;ao<aq.length;ao++){this[aq[ao]+an]=y}}return this};this.base=function(an,m,ao){if(an!==y){if(typeof an.pop=="function"){an={points:an,color:m,fill:ao}}}v.lines.prototype.base.call(this,an);this.shapesCount=0;if(an!==y){if(an.points!==y){this.points(an.points)}}return this}};v.lines.prototype=new v.shape;v.line=function(){this.draw=function(m){if(this._x0===y){return}m.moveTo(this._x0,this._y0);for(var an=1;an<this.shapesCount;an++){m.lineTo(this["_x"+an],this["_y"+an])}};this.base=function(an,m,ao){v.line.prototype.base.call(this,an,m,ao);return this};this._proto="line";this.pointNames=["_x","_y"]};v.line.prototype=new v.lines;v.qCurve=function(){this.draw=function(m){if(this._x0===y){return}m.moveTo(this._x0,this._y0);for(var an=1;an<this.shapesCount;an++){m.quadraticCurveTo(this["_cp1x"+an],this["_cp1y"+an],this["_x"+an],this["_y"+an])}};this.base=function(an,m,ao){v.qCurve.prototype.base.call(this,an,m,ao);return this};this._proto="qCurve";this.pointNames=["_x","_y","_cp1x","_cp1y"]};v.qCurve.prototype=new v.lines;v.bCurve=function(){this.draw=function(m){if(this._x0===y){return}m.moveTo(this._x0,this._y0);for(var an=1;an<this.shapesCount;an++){m.bezierCurveTo(this["_cp1x"+an],this["_cp1y"+an],this["_cp2x"+an],this["_cp2y"+an],this["_x"+an],this["_y"+an])}};this.base=function(an,m,ao){v.bCurve.prototype.base.call(this,an,m,ao);return this};this._proto="bCurve";this.pointNames=["_x","_y","_cp1x","_cp1y","_cp2x","_cp2y"]};v.bCurve.prototype=new v.lines;v.circle=function(){this.getRect=function(an){var m={x:this._x-this._radius,y:this._y-this._radius};m.width=m.height=this._radius*2;return b(this,m,an)};this.draw=function(m){m.arc(this._x,this._y,this._radius,0,u,true)};this.base=function(an,aq,m,ao,ap){if(typeof an!="object"){an={x:an,y:aq,radius:m,color:ao,fill:ap}}an=ab(an,{radius:0});v.circle.prototype.base.call(this,an);this._radius=an.radius;return this};this._proto="circle"};v.circle.prototype=new v.shape;v.rect=function(){this.getRect=function(m){return b(this,{x:this._x,y:this._y,width:this._width,height:this._height},m)};this.draw=function(m){m.rect(this._x,this._y,this._width,this._height)};this.base=function(an,ar,ap,m,ao,aq){if(typeof an!="object"){an={x:an,y:ar,width:ap,height:m,color:ao,fill:aq}}an=ab(an,{width:0,height:0});v.rect.prototype.base.call(this,an);this._width=an.width;this._height=an.height;return this};this._proto="rect"};v.rect.prototype=new v.shape;v.arc=function(){this.getRect=function(au){var av={x:this._x,y:this._y},at=this._startAngle,m=this._endAngle,ar=this._radius,ap=M(J(at/C)*ar),aq=M(x(at/C)*ar),aw=M(J(m/C)*ar),ax=M(x(m/C)*ar),ao=aq>0&&ax>0,an=aq<0&&ax<0,az=ap>0&&aw>0,ay=ap<0&&aw<0;av.width=av.height=ar;if((this._anticlockwise&&at<m)||(!this._anticlockwise&&at>m)){if(((an||(ao&&(ay||az))))||(aq==0&&ax==0)){av.y-=ar;av.height+=ar}else{if(ao&&aw<0&&ap>0){av.y+=aw;av.height+=aw}else{if(ax>0&&aw<0&&aq<0){av.y+=i(aw,ap);av.height-=i(aw,ap)}else{if(ay){av.y-=R(aw,ap)}else{av.y-=ar}av.height+=R(aw,ap)}}}if(((az||(ay&&(an||ao))))||(ap==0&&aw==0)){av.x-=ar;av.width+=ar}else{if(aw<0&&ap>0){av.x+=i(ax,aq);av.width-=i(ax,aq)}else{if(an){av.x-=R(ax,aq)}else{av.x-=ar}av.width+=R(ax,aq)}}}else{ao=aq>=0&&ax>=0;az=ap>=0&&aw>=0;an=aq<=0&&ax<=0;ay=ap<=0&&aw<=0;if(ay&&ao){av.x+=i(ax,aq);av.width-=i(ax,aq);av.y+=i(aw,ap);av.height+=R(aw,ap)}else{if(ay&&an){av.x+=i(ax,aq);av.width+=R(ax,aq);av.y+=i(aw,ap);av.height+=R(aw,ap)}else{if(ay){av.x+=i(ax,aq);av.width+=R(ax,aq);av.y-=ar;av.height+=R(aw,ap)}else{if(ao&&az){av.x+=i(ax,aq);av.width=W(ax-aq);av.y+=i(aw,ap);av.height-=i(aw,ap)}else{if(az){av.x+=i(ax,aq);av.width=W(ax)+W(aq);av.y+=i(aw,ap);av.height-=i(aw,ap)}else{if(an){av.x-=ar;av.width+=R(ax,aq);av.y-=ar;av.height+=R(aw,ap)}else{if(ao){av.x-=ar;av.width+=R(ax,aq);av.y-=ar;av.height+=ar}}}}}}}}return b(this,av,au)};this.draw=function(m){m.arc(this._x,this._y,this._radius,this._startAngle/C,this._endAngle/C,this._anticlockwise)};this.base=function(an,au,m,aq,ap,ar,ao,at){if(ar!==y){if(ar.charAt){ao=ar}if(ar){ar=true}else{ar=false}}if(typeof an!="object"){an={x:an,y:au,radius:m,startAngle:aq,endAngle:ap,anticlockwise:ar,color:ao,fill:at}}an=ab(an,{radius:0,startAngle:0,endAngle:0,anticlockwise:true});v.arc.prototype.base.call(this,an);this._radius=an.radius;this._startAngle=an.startAngle;this._endAngle=an.endAngle;this._anticlockwise=an.anticlockwise;return this};this._proto="arc"};v.arc.prototype=new v.shape;v.text=function(){this.font=function(m){return this.attr("font",m)};this._font="10px sans-serif";this.align=function(m){return this.attr("align",m)};this._align="start";this.baseline=function(m){return this.attr("baseline",m)};this._baseline="alphabetic";this.string=function(m){return this.attr("string",m)};this.position=function(){var an={x:this._x,y:this._y},m=B(this).optns.ctx;an.height=parseInt(this._font.match(O)[0]);an.y-=an.height;m.save();m.textBaseline=this._baseline;m.font=this._font;m.textAlign=this._align;an.width=m.measureText(this._string).width;m.restore();return b(this,an)};this.getRect=function(ao){var an={x:this._x,y:this._y},m=B(this).optns.ctx;an.height=parseInt(this._font.match(O)[0]);an.y-=an.height;m.save();m.textBaseline=this._baseline;m.font=this._font;m.textAlign=this._align;an.width=m.measureText(this._string).width;if(this._align=="center"){an.x-=an.width/2}if(this._align=="right"){an.x-=an.width}m.restore();return b(this,an,ao)};this.setOptns=function(m){v.text.prototype.setOptns.call(this,m);m.textBaseline=this._baseline;m.font=this._font;m.textAlign=this._align};this.draw=function(m){if(this._maxWidth===false){if(this._fill){m.fillText(this._string,this._x,this._y)}else{m.strokeText(this._string,this._x,this._y)}}else{if(this._fill){m.fillText(this._string,this._x,this._y,this._maxWidth)}else{m.strokeText(this._string,this._x,this._y,this._maxWidth)}}};this.base=function(ao,m,ar,ap,an,aq){if(ap!==y){if(ap.charAt){if(an!==y){aq=an}an=ap;ap=false}}if(typeof ao!="object"){ao={string:ao,x:m,y:ar,maxWidth:ap,color:an,fill:aq}}ao=ab(ao,{string:"",maxWidth:false,fill:1});v.text.prototype.base.call(this,ao);this._string=ao.string;this._maxWidth=ao.maxWidth;return this};this._proto="text"};v.text.prototype=new v.shape;v.grdntsnptrn=function(){this.layer=function(an){return e(an,this,"grdntsnptrns")};this.canvas=function(an){return l(an,this,"grdntsnptrns")};var m=new v.object;this.animate=m.animate;this.attr=m.attr;this.id=m.id;this.name=m.name;this.level=m.level;this.base=function(){this.animateQueue=[];this.optns={animated:false,name:"",layer:{id:aa[0].optns.id+"Layer_0",number:0},canvas:{number:0},visible:true};this.optns.layer.id=aa[U].optns.id+"Layer_0";this.optns.layer.number=0;this.optns.canvas.number=U;var an=aa[U].layers[0].grdntsnptrns;this._level=an.length;an[this._level]=this;j(this)};return this};v.gradients=function(){this.colorStopsCount=0;this.paramNames=["_pos","_colorR","_colorG","_colorB","_alpha"];this.addColorStop=function(ap,an){j(this);var m=r(an);var ao=this.colorStopsCount;this["_pos"+ao]=ap;this["_colorR"+ao]=m.r;this["_colorG"+ao]=m.g;this["_colorB"+ao]=m.b;this["_alpha"+ao]=m.a;this.colorStopsCount++;return this};this.animate=function(aq,at,au,ar,ap){for(var ao in aq){if(ao.substr(0,5)=="color"){var an=ao.substring(5);var m=r(aq[ao]);aq["colorR"+an]=m.r;aq["colorG"+an]=m.g;aq["colorB"+an]=m.b;aq["alpha"+an]=m.a}}v.gradients.prototype.animate.call(this,aq,at,au,ar,ap)};this.delColorStop=function(an){j(this);var m=this.colorStops();m.splice(an,1);if(m.length>0){this.colorStops(m)}else{this.colorStopsCount=0}return this};this.colorStops=function(ar){var aq=this.paramNames;if(ar===y){ar=[];for(var ao=0;ao<this.colorStopsCount;ao++){ar[ao]=[];for(var ap=0;ap<aq.length;ap++){ar[ao][ap]=this[aq[ap]+ao]}}return ar}j(this);var an=this.colorStopsCount;var m=ar.length;if(ar[0].length==2){for(ao=0;ao<m;ao++){this.addColorStop(ar[ao][0],ar[ao][1])}}else{for(ao=0;ao<m;ao++){for(ap=0;ap<aq.length;ap++){this[aq[ap]+ao]=ar[ao][ap]}}}for(ao=m;ao<an;ao++){for(ap=0;ap<aq.length;ap++){this[aq[ap]+ao]=y}}this.colorStopsCount=m;return this};this.base=function(m){v.gradients.prototype.base.call(this);if(m==y){return this}else{return this.colorStops(m)}}};v.gradients.prototype=new v.grdntsnptrn;v.pattern=function(){this.create=function(m){if(this.optns.animated){D.call(this)}this.val=m.createPattern(this._img,this._type)};this.base=function(an,m){if(an.onload){an={image:an,type:m}}an=ab(an,{type:"repeat"});v.pattern.prototype.base.call(this);this._img=an.image;this._type=an.type;return this};this._proto="pattern"};v.pattern.prototype=new v.grdntsnptrn;v.lGradient=function(){this.create=function(m){if(this.optns.animated){D.call(this)}this.val=m.createLinearGradient(this._x1,this._y1,this._x2,this._y2);for(var an=0;an<this.colorStopsCount;an++){this.val.addColorStop(this["_pos"+an],"rgba("+parseInt(this["_colorR"+an])+","+parseInt(this["_colorG"+an])+","+parseInt(this["_colorB"+an])+","+this["_alpha"+an]+")")}};this.base=function(ao,aq,an,ap,m){if(typeof ao!=="object"){ao={x1:ao,y1:aq,x2:an,y2:ap,colors:m}}ao=ab(ao,{x1:0,y1:0,x2:0,y2:0});v.lGradient.prototype.base.call(this,ao.colors);this._x1=ao.x1;this._y1=ao.y1;this._x2=ao.x2;this._y2=ao.y2;return this};this._proto="lGradient"};v.lGradient.prototype=new v.gradients;v.rGradient=function(){this.create=function(m){if(this.optns.animated){D.call(this)}this.val=m.createRadialGradient(this._x1,this._y1,this._r1,this._x2,this._y2,this._r2);for(var an=0;an<this.colorStopsCount;an++){this.val.addColorStop(this["_pos"+an],"rgba("+parseInt(this["_colorR"+an])+","+parseInt(this["_colorG"+an])+","+parseInt(this["_colorB"+an])+","+this["_alpha"+an]+")")}};this.base=function(aq,at,ap,ao,ar,an,m){if(typeof aq!=="object"){aq={x1:aq,y1:at,r1:ap,x2:ao,y2:ar,r2:an,colors:m}}aq=ab(aq,{x1:0,y1:0,r1:0,x2:0,y2:0,r2:0});v.rGradient.prototype.base.call(this,aq.colors);this._x1=aq.x1;this._y1=aq.y1;this._r1=aq.r1;this._x2=aq.x2;this._y2=aq.y2;this._r2=aq.r2;return this};this._proto="rGradient"};v.rGradient.prototype=new v.gradients;v.layer=function(){this.position=function(){var aq=this.objs,ap,m,ao,an=aq.length;for(ao=0;ao<an;ao++){m=aq[ao].position();if(ap===y){ap=m}if(ap.x>m.x){ap.x=m.x}if(ap.y>m.y){ap.y=m.y}}return ap};this.getRect=function(ap){var ar=this.objs,ao,aq,an,m=ar.length;if(ar.length==0){return false}if(ap=="coords"){for(an=0;an<m;an++){aq=ar[an].getRect(ap);if(ao===y){ao=aq}if(ao[0][0]>aq[0][0]){ao[0][0]=aq[0][0]}if(ao[0][1]>aq[0][1]){ao[0][1]=aq[0][1]}if(ao[1][0]<aq[1][0]){ao[1][0]=aq[1][0]}if(ao[1][1]>aq[1][1]){ao[1][1]=aq[1][1]}if(ao[2][0]>aq[2][0]){ao[2][0]=aq[2][0]}if(ao[2][1]<aq[2][1]){ao[2][1]=aq[2][1]}if(ao[3][0]<aq[3][0]){ao[3][0]=aq[3][0]}if(ao[3][1]<aq[3][1]){ao[3][1]=aq[3][1]}}return ao}for(an=0;an<m;an++){aq=ar[an].getRect(ap);if(ao===y){ao=aq}if(ao.x>aq.x){ao.x=aq.x}if(ao.y>aq.y){ao.y=aq.y}if(ao.width<aq.width){ao.width=aq.width}if(ao.height<aq.height){ao.height=aq.height}}ao.right=ao.width+ao.x;ao.bottom=ao.height+ao.y;return ao};this.canvas=function(an){if(an===y){return this.idCanvas}if(this.optns.canvas.id==an){return this}var aq=-1,m=0,at=aa.length;for(var ap=0;ap<at;ap++){var ar=aa[ap].optns.id;if(ar==an){aq=ap}if(ar==this.optns.canvas.id){m=ap}}if(aq<0){aq=aa.length;N.canvas(an)}this.optns.canvas.id=an;this.optns.canvas.number=aq;aa[m].layers.splice(this.optns.number,1);var ao=aa[aq].layers;this._level=this.optns.number=ao.length;ao[this._level]=this;k(this.objs,this.optns.id,this._level,an,aq);k(this.grdntsnptrns,this.optns.id,this._level,an,aq);aa[aq].optns.redraw=1;return this};this.up=function(an){if(an===y){an=1}if(an=="top"){this.level(an)}else{var m=B(this).layers[this.optns.number+an];if(m!==y){an=m._level+1-this._level}this.level(this._level+an)}return this};this.down=function(an){if(an==y){an=1}if(an=="bottom"){this.level(an)}else{var m=B(this).layers[this.optns.number-an];if(m!==y){an=this._level-(m._level-1)}this.level(this._level-an)}return this};this.level=function(ao){if(ao==y){return this._level}var an=B(this),m=an.optns;if(ao=="bottom"){if(this.optns.number==0){ao=this._level}else{ao=an.layers[0]._level-1}}if(ao=="top"){if(this.optns.number==an.layers.length-1){ao=this._level}else{ao=an.layers[an.layers.length-1]._level+1}}this._level=ao;m.anyLayerLevelChanged=true;m.redraw=1;return this};this.del=function(){var m=B(this).optns;m.anyLayerDeleted=true;this.draw=false;m.redraw=1;return};this.setOptns=function(m){m.setTransform(1,0,0,1,0,0);v.layer.prototype.setOptns.call(this,m);return this};this.afterDraw=function(m){m.ctx.closePath();m.ctx.restore();if(this.optns.clipObject){v.layer.prototype.afterDraw.call(this.optns.clipObject,m)}};this.clone=function(ao,m){var an=N.layer(ao);H(an,this);an.canvas(B(this).optns.id);if(m===y){return an}return an.animate(m)};this.isPointIn=function(m,aq,ao){var ap=this.objs,an;for(an=0;an<ap.length;an++){if(ap[an].isPointIn(m,aq,ao)){return true}}return false};this.opacity=function(ao){var an=this.objs;for(var m=0;m<an.length;m++){an[m].attr("opacity",ao)}return this};this.fadeTo=function(ar,ap,at,ao,an){if(ap===y){ap=600}var aq=this.objs;for(var m=0;m<aq.length;m++){aq[m].animate({opacity:ar},ap,at,ao,an)}return this};this.draw=function(m){var ap=this.optns.buffer;if(ap.val){m.drawImage(ap.cnv,ap.x,ap.y);return this}for(var ao=0;ao<this.grdntsnptrns.length;ao++){this.grdntsnptrns[ao].create(m)}if(this.optns.anyObjLevelChanged){Q(this.objs);this.optns.anyObjLevelChanged=false}if(this.optns.anyObjDeleted){T(this.objs);this.optns.anyObjDeleted=false}m.globalCompositeOperation=this.optns.gCO;for(ao=0;ao<this.objs.length;ao++){var an=this.objs[ao];if(typeof(an.draw)=="function"){this.setOptns(m);if(an.beforeDraw(m)){if(typeof(an.draw)=="function"){var aq=an.optns.buffer;if(aq.val){m.drawImage(aq.cnv,aq.x,aq.y)}else{an.draw(m)}if(ap.optns){an.afterDraw(ap.optns)}else{an.afterDraw(B(this).optns)}}}}}return this};this.base=function(ar){var an=aa[U],aq=an.layers,ao=an.optns;v.layer.prototype.base.call(this,0,0,true);var m=aq.length;aq[m]=this;this.objs=[];this.grdntsnptrns=[];this._level=m?(aq[m-1]._level+1):0;this.optns.number=m;this.optns.id=ar;var ap=this.optns;ap.anyObjDeleted=false;ap.anyObjLevelChanged=false;ap.gCO=ao.gCO;ap.canvas.id=ao.id;ap.canvas.number=U;return this};this._proto="layer"};v.layer.prototype=new v.object;function X(an){var m=new v.layer();return m.base(an)}v.imageData=function(){this.filter=function(m,ao){var an=g[m];an.fn.call(this,this._width,this._height,an.matrix,ao);return this};this.setPixel=function(an,aq,ao){var m,ap=(an+aq*this._width)*4;if(ao.r!==y){m=ao}else{if(ao[0]!==y){if(!ao.charAt){m={r:ao[0],g:ao[1],b:ao[2],a:ao[3]}}else{m=r(ao)}}}this._data[ap+0]=m.r;this._data[ap+1]=m.g;this._data[ap+2]=m.b;this._data[ap+3]=m.a*255;j(this);return this};this.getPixel=function(m,ao){var an=(m+ao*this._width)*4;return[this._data[an+0],this._data[an+1],this._data[an+2],this._data[an+3]/255]};this._getX=0;this._getY=0;this.getData=function(an,ar,ap,m){this._getX=an;this._getY=ar;this._width=ap;this._height=m;var ao=B(this).optns.ctx;try{this._imgData=ao.getImageData(this._getX,this._getY,this._width,this._height)}catch(aq){netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");this._imgData=ao.getImageData(this._getX,this._getY,this._width,this._height)}this._data=this._imgData.data;j(this);return this};this.putData=function(m,an){if(m!==y){this._x=m}if(an!==y){this._y=an}this._putData=true;j(this);return this};this.clone=function(){var m=v.imageData.prototype.clone.call(this);m._imgData=y;return m};this.draw=function(m){if(this._imgData===y){this._imgData=m.createImageData(this._width,this._height);for(var an=0;an<this._width*this._height*4;an++){this._imgData.data[an]=this._data[an]}this._data=this._imgData.data}if(this._putData){m.putImageData(this._imgData,this._x,this._y)}};this.base=function(aq,m){v.imageData.prototype.base.call(this);if(m===y){var ar=aq;if(ar._width!==y){aq=ar._width;m=ar._height}else{aq=ab(aq,{width:0,height:0});m=aq.height;aq=aq.width}}this._width=aq;this._height=m;this._data=[];for(var ap=0;ap<this._width;ap++){for(var ao=0;ao<this._height;ao++){var an=(ap+ao*this._width)*4;this._data[an+0]=0;this._data[an+1]=0;this._data[an+2]=0;this._data[an+3]=0}}return this};this._putData=false;this._proto="imageData"};v.imageData.prototype=new v.object;v.image=function(){this.getRect=function(an){var m={x:this._x,y:this._y,width:this._width,height:this._height};return b(this,m,an)};this.draw=function(m){m.drawImage(this._img,this._sx,this._sy,this._swidth,this._sheight,this._x,this._y,this._width,this._height)};this.base=function(ao,au,aq,m,av,at,ar,ap,an){if(typeof ao!="object"||ao.onload){ao={image:ao,x:au,y:aq,width:m,height:av,sx:at,sy:ar,swidth:ap,sheight:an}}ao=ab(ao,{width:false,height:false,sx:0,sy:0,swidth:false,sheight:false});if(ao.width===false){ao.width=ao.image.width;ao.height=ao.image.height}if(ao.swidth===false){ao.swidth=ao.image.width;ao.sheight=ao.image.height}v.image.prototype.base.call(this,ao);this._img=ao.image;this._width=ao.width;this._height=ao.height;this._sx=ao.sx;this._sy=ao.sy;this._swidth=ao.swidth;this._sheight=ao.sheight;return this};this._proto="image"};v.image.prototype=new v.object;v.groups=function(){for(var m in v){if(m=="group"||m=="groups"){continue}var ao=new v[m];for(var an in ao){if(typeof ao[an]=="function"&&this[an]===y){(function(aq,ap){aq[ap]=function(){var av=[];var ar=[];var au=0;while(arguments[au]!==y){ar[au]=arguments[au++]}for(au=0;au<this.elements.length;au++){var at=this.elements[au];H(av,ar);if(typeof at[ap]=="function"){at[ap].apply(at,av)}}return this}})(this,an)}}}this.base=function(){this.elements=[];return this}};v.group=function(){this._proto="group"};v.group.prototype=new v.groups;function E(){var m=new v.group;return m.base()}N.addFunction=function(an,ao,m){v[m||"object"].prototype[an]=ao;return N};N.addObject=function(ao,aq,m,ap){v[ao]=function(ar){this.draw=v[ar].draw;this.base=v[ar].base;this._proto=ar};var an=v[ao];if(ap===y){ap="shape"}an.prototype=new v[ap];an.draw=m;an.base=function(at,aw,ar){an.prototype.base.call(this,aw);var av=0;for(var au in aw){this["_"+au]=ar[av]||aw[au];if(au=="color"){this.color(ar[av]||aw[au])}av++}return this};(function(ar,at){N[ar]=function(){var au=new v[ar](ar);return au.base(ar,at,arguments)}})(ao,aq);return N};N.addAnimateFunction=function(m,an){h[m]=an;return N};N.addImageDataFilter=function(m,an){if(g[m]===y){g[m]={}}if(an.fn!==y){g[m].fn=an.fn}if(an.matrix!==y&&an.type===y){g[m].matrix=an.matrix}if(an.type!==y){g[m].matrix[type]=an.matrix}return N};N.clear=function(m){if(aa[0]===y){return N}if(m===y){aa[0].clear();return N}N.canvas(m).clear();return N};N.pause=function(m){if(m===y){aa[0].pause();return N}N.canvas(m).pause();return N};N.start=function(m,an){N.canvas(m).start(an);return N};N.pattern=function(m,an){var ao=new v.pattern;return ao.base(m,an)};N.lGradient=function(ao,aq,an,ap,m){var ar=new v.lGradient;return ar.base(ao,aq,an,ap,m)};N.rGradient=function(aq,at,ap,ao,ar,an,m){var au=new v.rGradient;return au.base(aq,at,ap,ao,ar,an,m)};N.line=function(ao,an,ap){var m=new v.line;return m.base(ao,an,ap)};N.qCurve=function(ao,m,ap){var an=new v.qCurve;return an.base(ao,m,ap)};N.bCurve=function(an,m,ap){var ao=new v.bCurve;return ao.base(an,m,ap)};N.imageData=function(an,m){var ao=new v.imageData;return ao.base(an,m)};N.image=function(aq,av,ar,m,aw,au,at,ap,an){var ao=new v.image;return ao.base(aq,av,ar,m,aw,au,at,ap,an)};N.circle=function(an,ar,m,ao,aq){var ap=new v.circle;return ap.base(an,ar,m,ao,aq)};N.rect=function(an,at,ap,m,ao,ar){var aq=new v.rect;return aq.base(an,at,ap,m,ao,ar)};N.arc=function(au,at,aq,ar,an,ao,ap,av){var m=new v.arc;return m.base(au,at,aq,ar,an,ao,ap,av)};N.text=function(ao,m,at,ap,an,aq){var ar=new v.text;return ar.base(ao,m,at,ap,an,aq)};N.canvas=function(an){if(an===y){return aa[0]}var m=aa.length;for(var ap=0;ap<m;ap++){if(aa[ap].optns){if(aa[ap].optns.id==an){return aa[ap]}}}var ao={id:function(aq){if(aq===y){return this.optns.id}this.optns.id=aq;return this}};aa[m]=ao;U=m;ao.cnv=document.getElementById(an);if("\v"=="v"){if(typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(ao.cnv)}if(typeof FlashCanvas!=="undefined"){FlashCanvas.initElement(ao.cnv)}}ao.optns={id:an,number:U,ctx:ao.cnv.getContext("2d"),width:ao.cnv.offsetWidth,height:ao.cnv.offsetHeight,anyLayerDeleted:false,anyLayerLevelChanged:false,keyDown:{val:false,code:false},keyUp:{val:false,code:false},keyPress:{val:false,code:false},mousemove:{val:false,x:false,y:false,object:false},click:{val:false,x:false,y:false,object:false},dblclick:{val:false,x:false,y:false,object:false},mouseup:{val:false,x:false,y:false,object:false},mousedown:{val:false,x:false,y:false,object:false},drag:{object:false,x:0,y:0},gCO:"source-over",redraw:1};ao.toDataURL=function(){return ao.cnv.toDataURL.apply(ao.cnv,arguments)};ao.layers=[];ao.interval=0;N.layer(an+"Layer_0").canvas(an);ao.start=function(ar){U=this.optns.number;if(ar){if(this.interval){return this}this.isAnimated=ar;var at=A(this.cnv);this.optns.x=at.left;this.optns.y=at.top;var aq=aa[this.optns.number];this.cnv.onclick=function(au){if(!aq.optns.click.val){return}t(au,"click",aq.optns)};this.cnv.ondblclick=function(au){if(!aq.optns.dblclick.val){return}t(au,"dblclick",aq.optns)};this.cnv.onmousedown=function(au){if(!aq.optns.mousedown.val){return}t(au,"mousedown",aq.optns)};this.cnv.onmouseup=function(au){if(!aq.optns.mouseup.val){return}t(au,"mouseup",aq.optns)};this.cnv.onkeyup=function(au){ac(au,"keyUp",aq.optns)};this.cnv.onkeydown=function(au){ac(au,"keyDown",aq.optns)};this.cnv.onkeypress=function(au){ac(au,"keyPress",aq.optns)};this.cnv.onmouseout=this.cnv.onmousemove=function(ax){if(!aq.optns.mousemove.val){return}t(ax,"mousemove",aq.optns);if(aq.optns.drag.object!=false){var aw=aq.optns.drag;var av=aq.optns.mousemove;var au=Z(av.x,av.y,aw.object.matrix());aw.object.transform(1,0,0,1,au.x-aw.x,au.y-aw.y);if(aw.fn){aw.fn.call(aw.object,({x:av.x,y:av.y}))}}};this.interval=c(function(){aq.interval=aq.interval||1;aq.frame()},this.cnv)}else{return this.frame()}return this};ao.pause=function(){G(this.interval);this.interval=0};ao.del=function(){G(this.interval);this.layers=[];aa.splice(this.optns.number,1);for(var au=0;au<aa.length;au++){var ar=aa[au],av=ar.layers,aw=av.length;ar.optns.number=au;for(var aq=0;aq<aw;aq++){var at=av[aq];at.optns.canvas.number=au;k(at.objs,at.optns.id,at.optns.number,ar.optns.id,ar.optns.number);k(at.grdntsnptrns,at.optns.id,at.optns.number,ar.optns.id,ar.optns.number)}}if(this.cnv.parentNode){this.cnv.parentNode.removeChild(this.cnv)}U=0;return false};ao.clear=function(){G(this.interval);this.interval=0;this.layers=[];N.layer(this.optns.id+"Layer_0").canvas(this.optns.id);this.optns.ctx.clearRect(0,0,this.optns.width,this.optns.height);this.optns.redraw++;return this};ao.frame=function(){var aq=this.optns,ay=this;if(this.interval){this.interval=c(function(){ay.frame()},this.cnv);this.interval=this.interval||1}if(!aq.redraw){return this}aq.redraw--;aq.ctx.clearRect(0,0,aq.width,aq.height);if(this.layers.length==0){return this}m=this.layers.length;if(aq.anyLayerLevelChanged){m=Q(this.layers)}if(aq.anyLayerDeleted){m=T(this.layers)}if(aq.anyLayerLevelChanged||aq.anyLayerDeleted){aq.anyLayerLevelChanged=aq.anyLayerDeleted=false;for(var av=0;av<m;av++){var aA=this.layers[av],ar=aA.optns;k(aA.objs,ar.id,ar.number,this.optns.id,this.optns.number);k(aA.grdntsnptrns,ar.id,ar.number,an,this.optns.number)}}for(av=0;av<m;av++){var au=this.layers[av];if(typeof(au.draw)=="function"){if(au.beforeDraw(aq.ctx)){if(typeof(au.draw)=="function"){au.draw(aq.ctx);au.afterDraw(aq)}}}}if(aq.mousemove.x!=false){var aF=this.optns.point||{};aF.event=aq.mousemove.event;if(aq.mousemove.object!=false){var at=aq.mousemove.object;if(L===at){if(typeof at.onmousemove=="function"){at.onmousemove(aF)}}else{if(L==false){if(typeof at.onmouseover=="function"){at.onmouseover(aF)}}else{if(typeof L.onmouseout=="function"){L.onmouseout(aF)}if(typeof at.onmouseover=="function"){at.onmouseover(aF)}}L=at}}else{if(L!==false){if(typeof L.onmouseout=="function"){L.onmouseout(aF)}L=false}}}if(aq.mousedown.object!=false){var ax=this.optns.mousedown;var aE=[ax.object,af(ax.object)];for(av=0;av<2;av++){if(typeof aE[av].onmousedown=="function"){aE[av].onmousedown({x:ax.x,y:ax.y,event:ax.event})}if(aE[av].optns.drag.val==true){var aw=aq.drag;aw.object=aE[av].optns.drag.object.visible(true);aw.fn=aE[av].optns.drag.fn;aw.init=aE[av];if(aw.init.optns.drag.params!==y){aw.object.animate(aw.init.optns.drag.params)}aF=Z(ax.x,ax.y,aw.object.matrix());aw.x=aF.x;aw.y=aF.y;if(aw.object!=aw.init&&aw.init.optns.drag.type!="clone"){aF.x=-aw.object._x+aF.x;aF.y=-aw.object._y+aF.y;aw.x-=aF.x;aw.y-=aF.y;aw.object.transform(1,0,0,1,aF.x,aF.y)}aw.object._transformdx+=aw.init.optns.drag.shiftX;aw.object._transformdy+=aw.init.optns.drag.shiftY}}ax.object=false}if(aq.mouseup.object!=false){var az=aq.mouseup;var aH=[az.object,af(az.object)];aw=aq.drag;for(av=0;av<2;av++){if(typeof aH[av].onmouseup=="function"){aH[av].onmouseup({x:az.x,y:az.y,event:az.event})}if(aH[av].optns.drop.val==true&&aq.drag.init!==y){if(aw.init==aw.object){aw.init.visible(true)}if(typeof aH[av].optns.drop.fn=="function"){aH[av].optns.drop.fn.call(aH[av],aw.init)}this.optns.drag={object:false,x:0,y:0}}else{if(aw.init!==y){aw.object.visible(false);aw.init.visible(true);aw.init._transformdx=aw.object._transformdx;aw.init._transformdy=aw.object._transformdy;if(aw.object!=aw.init){aw.object.visible(false)}this.optns.drag={object:false,x:0,y:0}}}}az.object=false}if(this.optns.click.object!=false){var aG=this.optns.click;var aB=[aG.object,af(aG.object)];for(av=0;av<2;av++){if(typeof aB[av].onclick=="function"){aB[av].onclick({x:aG.x,y:aG.y,event:aG.event})}}aG.object=false}if(this.optns.dblclick.object!=false){var aC=this.optns.dblclick;var aD=[aC.object,af(aC.object)];for(av=0;av<2;av++){if(typeof aD[av].ondblclick=="function"){aD[av].ondblclick({x:aC.x,y:aC.y,event:aC.event})}}aC.object=false}this.optns.mousemove.object=this.optns.keyUp.val=this.optns.keyDown.val=this.optns.keyPress.val=this.optns.click.x=this.optns.dblclick.x=this.optns.mouseup.x=this.optns.mousedown.x=this.optns.mousemove.x=false;return this};return ao};N.layer=function(ap){if(ap===y){return aa[0].layers[0]}for(var ao=0;ao<aa.length;ao++){var an=aa[ao].layers;for(var m=0;m<an.length;m++){if(an[m].optns.id==ap){return an[m]}}}return X(ap)};Y.jCanvaScript=Y.jc=N})(window,undefined);